

<!DOCTYPE html>
<html style="height: 100%">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>nps-中国地图</title>

    <link rel="shortcut icon" href="favicon.ico"> <link href="css/bootstrap.min.css?v=3.3.5" rel="stylesheet">
    <link href="css/font-awesome.min.css?v=4.4.0" rel="stylesheet">
    <link href="css/animate.min.css" rel="stylesheet">
    <link href="css/style.min.css?v=4.0.0" rel="stylesheet"><base target="_blank">
</head>
<body style="height: 100%; margin: 0">
<div id="container" style="height: 100%"></div>
<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/echarts-all-3.js"></script>
<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-stat/ecStat.min.js"></script>
<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/dataTool.min.js"></script>
<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/china.js"></script>
<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/world.js"></script>
<!--<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=ZUONbpqGBsYGXNIYHicvbAbM"></script>-->
<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/bmap.min.js"></script>
<script type="text/javascript">
    var dom = document.getElementById("container");
    var myChart = echarts.init(dom);

    var data = [{
        "time": 1970,
        "data": [{
            "name": "United States of America",
            "value": [1025000, 31.222, "美国分部"]
        }, {
            "name": "Russia",
            "value": [433412, 13.202, "俄国分部"]
        }, {
            "name": "Japan",
            "value": [209071, 6.369, "日本分部"]
        }, {
            "name": "Germany",
            "value": [208867, 6.362, "德国分部"]
        }, {
            "name": "France",
            "value": [146982, 4.477, "法国分部"]
        }, {
            "name": "United Kingdom",
            "value": [124970, 3.807, "英国分部"]
        }, {
            "name": "Italy",
            "value": [109260, 3.328, "意大利分部"]
        }, {
            "name": "China",
            "value": [91506, 2.787, "中国分部"]
        }, {
            "name": "Canada",
            "value": [86303, 2.629, "加拿大分部"]
        }, {
            "name": "India",
            "value": [61470, 1.873, "印度分部"]
        }]
    }, {
            "time": 1980,
            "data": [{
                "name": "United States of America",
                "value": [2768900, 23.337, "美国分部"]
            }, {
                "name": "Japan",
                "value": [1086988, 9.027, "日本分部"]
            }, {
                "name": "Russia",
                "value": [940038, 7.923, "俄国分部"]
            }, {
                "name": "Germany",
                "value": [919651, 6.253, "德国分部"]
            }, {
                "name": "France",
                "value": [691157, 5.825, "法国分部"]
            }, {
                "name": "United Kingdom",
                "value": [541917, 4.567, "英国分部"]
            }, {
                "name": "Italy",
                "value": [459811, 3.875, "意大利分部"]
            }, {
                "name": "China",
                "value": [306520, 2.583, "中国分部"]
            }, {
                "name": "Canada",
                "value": [268889, 2.266, "加拿大分部"]
            }, {
                "name": "Mexico",
                "value": [227664, 1.919, "墨西哥分部"]
            }]
        }, {
            "time": 1990,
            "data": [{
                "name": "United States of America",
                "value": [5754800, 25.921, "美国分部"]
            }, {
                "name": "Japan",
                "value": [3103698, 13.774, "日本分部"]
            }, {
                "name": "Germany",
                "value": [1714447, 7.722, "德国分部"]
            }, {
                "name": "France",
                "value": [1244419, 5.605, "法国分部"]
            }, {
                "name": "Italy",
                "value": [1133465, 5.105, "意大利分部"]
            }, {
                "name": "United Kingdom",
                "value": [1012617, 4.561, "英国分部"]
            }, {
                "name": "Russia",
                "value": [775810, 3.501, "俄国分部"]
            }, {
                "name": "Canada",
                "value": [582735, 2.625, "加拿大分部"]
            }, {
                "name": "Spain",
                "value": [520938, 2.346, "西班牙分部"]
            }, {
                "name": "China",
                "value": [404494, 1.822, "中国分部"]
            }]
        }, {
            "time": 2000,
            "data": [{
                "name": "United States of America",
                "value": [9898800, 30.659, "美国分部"]
            }, {
                "name": "Japan",
                "value": [4731199, 14.456, "日本分部"]
            }, {
                "name": "Germany",
                "value": [1886400, 5.843, "德国分部"]
            }, {
                "name": "United Kingdom",
                "value": [1477132, 4.575, "英国分部"]
            }, {
                "name": "France",
                "value": [1326333, 4.108, "法国分部"]
            }, {
                "name": "China",
                "value": [1192836, 3.695, "中国分部"]
            }, {
                "name": "Italy",
                "value": [1097343, 3.399, "意大利分部"]
            }, {
                "name": "Canada",
                "value": [724914, 2.245, "加拿大分部"]
            }, {
                "name": "Brazil",
                "value": [644729, 1.997, "巴西分部"]
            }, {
                "name": "Mexico",
                "value": [636731, 1.972, "墨西哥分部"]
            }]
        }, {
            "time": 2010,
            "data": [{
                "name": "United States of America",
                "value": [14419600, 22.679, "美国分部"]
            }, {
                "name": "China",
                "value": [5951462, 9.360, "中国分部"]
            }, {
                "name": "Japan",
                "value": [5488424, 8.632, "日本分部"]
            }, {
                "name": "Germany",
                "value": [3306028, 5.200, "德国分部"]
            }, {
                "name": "France",
                "value": [2565755, 4.035, "法国分部"]
            }, {
                "name": "United Kingdom",
                "value": [2266049, 3.564, "英国分部"]
            }, {
                "name": "Brazil",
                "value": [2143035, 3.371, "巴西分部"]
            }, {
                "name": "Italy",
                "value": [2056941, 3.235, "意大利分部"]
            }, {
                "name": "India",
                "value": [1678297, 2.640, "印度分部"]
            }, {
                "name": "Canada",
                "value": [1577040, 2.480, "加拿大分部"]
            }]
        }, {
            "time": 2015,
            "data": [{
                "name": "United States of America",
                "value": [17947000, 23.208, "美国分部"]
            }, {
                "name": "China",
                "value": [10982829, 14.204, "中国分部"]
            }, {
                "name": "Japan",
                "value": [4123258, 5.329, "日本分部"]
            }, {
                "name": "Germany",
                "value": [3357614, 4.333, "德国分部"]
            }, {
                "name": "United Kingdom",
                "value": [2849345, 3.685, "英国分部"]
            }, {
                "name": "France",
                "value": [2421560, 3.130, "法国分部"]
            }, {
                "name": "India",
                "value": [2090706, 2.703, "印度分部"]
            }, {
                "name": "Italy",
                "value": [1815757, 2.347, "意大利分部"]
            }, {
                "name": "Brazil",
                "value": [1772589, 2.289, "巴西分部"]
            }, {
                "name": "Canada",
                "value": [1552386, 2.005, "加拿大分部"]
            }]
    }];


    var option = {
        backgroundColor: '',
        baseOption: {
            animationDurationUpdate: 1000,
            animationEasingUpdate: '',
            timeline: {
                axisType: 'category',
                orient: 'vertical',
                autoPlay: true,
                inverse: true,
                playInterval: 5000,
                left: null,
                right: 5,
                top: 20,
                bottom: 20,
                width: 46,
                height: null,
                label: {
                    normal: {
                        textStyle: {
                            color: '#ddd'
                        }
                    },
                    emphasis: {
                        textStyle: {
                            color: '#fff'
                        }
                    }
                },
                symbol: 'none',
                lineStyle: {
                    color: '#555'
                },
                checkpointStyle: {
                    color: '#bbb',
                    borderColor: '#777',
                    borderWidth: 1
                },
                controlStyle: {
                    showNextBtn: false,
                    showPrevBtn: false,
                    normal: {
                        color: '#666',
                        borderColor: '#666'
                    },
                    emphasis: {
                        color: '#aaa',
                        borderColor: '#aaa'
                    }
                },
                data: data.map(function(ele) {
                    return ele.time
                })
            },
            backgroundColor: '#25499F',
            title: {
                text: '历年全球通信行业数量变化情况',
                subtext: '统计单位:万',
                left: 'center',
                top: 'top',
                textStyle: {
                    fontSize: 25,
                    color: 'rgba(255,255,255, 0.9)'
                }
            },
            tooltip: {
                formatter: function(params) {
                    if ('value' in params.data) {
                        return params.data.value[2] + ': ' + params.data.value[0];
                    }
                }
            },
            grid: {
                left: 10,
                right: '45%',
                top: '70%',
                bottom: 5
            },
            xAxis: {},
            yAxis: {},
            series: [{
                id: 'map',
                type: 'map',
                mapType: 'world',
                top: '10%',
                //bottom: '25%',
                //left: '5%',
                //right: '10%',
                itemStyle: {
                    normal: {
                        areaColor: '#323c48',
                        borderColor: '#404a59'
                    },
                    emphasis: {
                        label: {
                            show: true
                        },
                        areaColor: 'rgba(255,255,255, 0.5)'
                    }
                },
                data: []
            }, {
                id: 'bar',
                type: 'bar',
                tooltip: {
                    show: false
                },
                label: {
                    normal: {
                        show: true,
                        position: 'right',
                        textStyle: {
                            color: '#ddd'
                        }
                    }
                },
                data: []
            }, {
                id: 'pie',
                type: 'pie',
                radius: ['12%', '20%'],
                center: ['75%', '85%'],
                //roseType: 'area',
                tooltip: {
                    formatter: '{b} {d}%'
                },
                data: [],
                label: {
                    normal: {
                        textStyle: {
                            color: '#ddd'
                        }
                    }
                },
                labelLine: {
                    normal: {
                        lineStyle: {
                            color: '#ddd'
                        }
                    }
                },
                itemStyle: {
                    normal: {
                        borderColor: 'rgba(0,0,0,0.3)',
                        borderSize: 1
                    }
                }
            }]
        },
        options: []
    }

    for (var i = 0; i < data.length; i++) {
        //计算其余国家GDP
        var restPercent = 100;
        var restValue = 0;
        data[i].data.forEach(function(ele) {
            restPercent = restPercent - ele.value[1];
        });
        restValue = data[i].data[0].value[0] * (restPercent / data[i].data[0].value[1]);
        console.log(restPercent);
        console.log(restValue);
        option.options.push({
            visualMap: [{
                //type:'continous',
                //type: 'continuous',
                calculable: true,
                dimension: 0,
                left: 10,
                top: 'center',
                itemWidth: 12,
                min: data[i].data[9].value[0],
                max: data[i].data[0].value[0],
                text: ['High', 'Low'],
                textStyle: {
                    color: '#ddd'
                },
                inRange: {
                    //color: ['lightskyblue', 'yellow', 'orangered', 'red']
                    color: ['lightskyblue', 'yellow', 'white']
                }
            }],
            xAxis: {
                type: 'value',
                boundaryGap: [0, 0.1],
                axisLabel: {
                    show: false,
                },
                splitLine: {
                    show: false
                }
            },
            yAxis: {
                type: 'category',
                axisLabel: {
                    show: false,
                    textStyle: {
                        color: '#ddd'
                    }
                },

                data: data[i].data.map(function(ele) {
                    return ele.value[2]
                }).reverse()
            },
            series: [{
                id: 'map',
                data: data[i].data
            }, {
                id: 'bar',
                label: {
                    normal: {
                        position: 'right',
                        formatter: '{b} : {c}'
                    }
                },
                data: data[i].data.map(function(ele) {
                    return ele.value[0]
                }).sort(function(a, b) {
                    return a > b
                })
            }, {
                id: 'pie',
                data: data[i].data.map(function(ele) {
                    return {
                        name: ele.value[2],
                        value: ele.value
                    }
                }).concat({
                    name: '其他国家',
                    value: restValue
                }),
            }]
        })
    }

    if (option && typeof option === "object") {
        myChart.setOption(option, true);
    }
</script>
</body>
</html>